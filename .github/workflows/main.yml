    name: Conda Python Tests

    on:
      push:
        branches:
          - main
      pull_request:
        branches:
          - main

    jobs:
      test:
        runs-on: ubuntu-latest
        strategy:
          matrix:
            python-version: ["3.10", "3.11", "3.12", "3.13"]
            conda-version: ["latest"] 

        steps:
          - name: Checkout repository
            uses: actions/checkout@v4

          - name: Set up Miniconda
            uses: conda-incubator/setup-miniconda@v3
            with:
              miniconda-version: ${{ matrix.conda-version }}
              python-version: ${{ matrix.python-version }}
              activate-environment: test-env # Name of the conda environment
              auto-update-conda: true
              conda-remove-defaults: true

          - name: Install dependencies
            shell: bash -l {0} # Use login shell for conda environment activation
            run: |
              conda install -y pip # Ensure pip is installed in the environment
              make setup

          - name: Run tests
            shell: bash -l {0} # Use login shell for conda environment activation
            run: |
              python3 -m pytest -v